define(['jquery', 'eve', 'settings', 'mixins/registerPluginMixin'], function ($, eve, settings, registerPlugin) {

    var Item = function (pluginId, element) {
        this.pluginId = pluginId;
        this.item = $(element);
    };

    Item.prototype = {
        activate : function () {
            dispatch.call(this, 'activate', 'activated', false);
        },

        deactivate : function () {
            dispatch.call(this, 'deactivate', 'deactivated', true);
        }
    };

    function dispatch(pre, post, ret) {
        var that = this;

        eve([settings.appName, pre, pluginId, 'item'].join('.'), that.item);

        setTimeout(function () {
            eve(['atlas', post, pluginId, 'item'].join('.'), that.item);
        }, 0);

        return ret;        
    }

    registerPlugin('item', Item);
    
    return Item;
});